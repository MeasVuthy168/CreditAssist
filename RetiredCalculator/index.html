
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Notification Badge Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #1c2331; color: white; }
    .notification-btn {
      position: relative;
      background: #0d2d5c;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    #notif-badge {
      display: none;
      position: absolute;
      top: -4px;
      right: -6px;
      background: red;
      color: white;
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 50%;
    }
  </style>
</head>
<body>

<h2>Notification Badge Test</h2>
<button class="notification-btn" onclick="checkMockNotification()">
  Notification
  <span id="notif-badge">!</span>
</button>

<pre id="debug-log" style="margin-top: 20px; background: #2e3646; padding: 10px;"></pre>

<script>
function checkMockNotification() {
  const debug = document.getElementById("debug-log");
  const notifBadge = document.getElementById("notif-badge");

  const mockUsername = "10522";
  const lastRead = new Date("2025-04-30T12:00:00.000Z");
  const uploads = {
    user: "2025-05-01T17:56:21.529Z",    // after last read
    customer: null,
    turnover: "2025-05-01T16:49:25.185Z", // after last read
    nbcos: null,
    [`read_${mockUsername}`]: lastRead.toISOString()
  };

  debug.textContent = "ðŸ§ª Comparing with last read time...\n";

  let hasNew = false;
  for (const key of ['user', 'customer', 'turnover', 'nbcos']) {
    const uploadedAt = uploads[key] ? new Date(uploads[key]) : null;
    if (uploadedAt && uploadedAt > lastRead) {
      debug.textContent += `ðŸ”” ${key.toUpperCase()} is NEW (uploaded at ${uploadedAt.toISOString()})\n`;
      hasNew = true;
    } else {
      debug.textContent += `âœ… ${key.toUpperCase()} is OLD or not uploaded\n`;
    }
  }

  notifBadge.style.display = hasNew ? "inline-block" : "none";
  debug.textContent += `\nResult: Badge ${hasNew ? "SHOWN" : "HIDDEN"}`;
}
</script>

</body>
</html>
